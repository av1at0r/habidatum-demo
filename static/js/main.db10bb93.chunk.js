(this["webpackJsonphabidatum-demo"]=this["webpackJsonphabidatum-demo"]||[]).push([[0],{35:function(e,t,a){e.exports=a(44)},44:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(26),i=a.n(o),c=a(62),u=a(5),l=a(59),s=a(64),d=a(60),p=a(61),m=a(7),f=a(33),h=a(15),b=a.n(h),g=a(23);function j(e,t){var a=e.map,r=e.loaded,o=t.source,i=t.id,c=t.type,u=t.paint;Object(n.useEffect)((function(){a.current&&r&&(a.current.getLayer(i)&&a.current.removeLayer(i),a.current.addLayer({id:i,source:o,type:c,paint:u}))}),[i,r,a,u,o,c])}function v(e,t){var a=e.map,r=e.loaded,o=Object(n.useState)([]),i=Object(u.a)(o,2),c=i[0],l=i[1];return Object(n.useEffect)((function(){if(a.current&&r){var e=a.current.getSource(t.sourceId);e?e.setData(n().data):a.current.addSource(t.sourceId,n())}function n(){return{type:"geojson",data:{type:"FeatureCollection",features:c.map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e.coordinates.lon,e.coordinates.lat]},properties:e.properties}}))}}}}),[r,a,t.sourceId,c]),{points:c,setPoints:l}}var O={"circle-radius":5,"circle-color":"#007cbf"},E={"text-field":["get","title"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,2],"text-anchor":"bottom","text-ignore-placement":!0};function y(e){var t=v(e,{sourceId:"points",layerId:"point"}),a=v(e,{sourceId:"highlighted-points",layerId:"highlighted-point"});j(e,{id:"point",source:"points",paint:O,type:"circle"});var r=Object(n.useState)({"circle-radius":O["circle-radius"],"circle-color":"#FF0000"}),o=Object(u.a)(r,2),i=o[0],c=o[1],l=Object(n.useState)({"text-halo-color":"rgba(255, 255, 255, 0.8)","text-halo-width":10}),s=Object(u.a)(l,2),d=s[0],p=s[1];return j(e,{id:"highlighted-point",source:"highlighted-points",paint:i,type:"circle"}),function(e,t){var a=e.map,r=e.loaded,o=t.source,i=t.id,c=t.layout,u=t.paint;Object(n.useEffect)((function(){a.current&&r&&(a.current.getLayer(i)&&a.current.removeLayer(i),a.current.addLayer({id:i,source:o,type:"symbol",layout:c,paint:u}))}),[i,c,r,a,u,o])}(e,{id:"highlighted-label",source:"highlighted-points",layout:E,paint:d}),{points:t,highlightedPoints:a,setHighlightedPointScale:Object(n.useCallback)((function(e){c({"circle-radius":7*e,"circle-color":"#FF0000"}),p({"text-halo-color":"rgba(255, 255, 255, 0.8)","text-halo-width":10})}),[])}}b.a.accessToken="pk.eyJ1IjoibmlraXRhbGkiLCJhIjoiY2tnajJzdGZrMDNuNDJzcDlpcjFvcDVkOSJ9.-QspCzoFYrNoP41d3ZL_Mg";var S=[],x=function(e){var t=e.rides,a=void 0===t?S:t,o=e.selectedRideIndex,i=Object(f.a)(e,["rides","selectedRideIndex"]),c=function(e){var t=Object(n.useRef)(),a=Object(n.useRef)(null),r=Object(n.useState)(!1),o=Object(u.a)(r,2),i=o[0],c=o[1];return Object(n.useEffect)((function(){if(a.current){var n=t.current=new b.a.Map(Object(g.a)(Object(g.a)({},e),{},{container:a.current}));return t.current.on("load",(function(){c(!0)})),function(){n.remove()}}}),Object.values(e)),{map:t,mapContainer:a,loaded:i}}({style:"mapbox://styles/mapbox/streets-v11"}),l=c.map,s=c.mapContainer,d=c.loaded,p=Object(n.useMemo)((function(){if(0!==a.length){var e=[].concat(Object(m.a)(a.map((function(e){return e.startStationLongitude}))),Object(m.a)(a.map((function(e){return e.endStationLongitude})))),t=[].concat(Object(m.a)(a.map((function(e){return e.startStationLatitude}))),Object(m.a)(a.map((function(e){return e.endStationLatitude})))),n=Math.min.apply(Math,Object(m.a)(e)),r=Math.max.apply(Math,Object(m.a)(e)),o=Math.min.apply(Math,Object(m.a)(t));return{lon:n+(r-n)/2,lat:o+(Math.max.apply(Math,Object(m.a)(t))-o)/2}}}),[a]),h=Object(n.useMemo)((function(){return{minRideDuration:Math.min.apply(Math,Object(m.a)(a.map((function(e){return e.tripduration})))),maxRideDuration:Math.max.apply(Math,Object(m.a)(a.map((function(e){return e.tripduration}))))}}),[a]),j=h.minRideDuration,v=h.maxRideDuration,O=Object(n.useCallback)((function(e){return(e-j)/(v-j)*1+1}),[v,j]);Object(n.useEffect)((function(){l.current&&p&&(l.current.setZoom(13),l.current.setCenter(p))}),[p,l,a,a.length]);var E=y({map:l,loaded:d}),x=E.setHighlightedPointScale,L=E.points,M=E.highlightedPoints;return Object(n.useEffect)((function(){if("undefined"!==typeof o){var e=a[o];x(O(e.tripduration))}}),[O,a,o,x]),Object(n.useEffect)((function(){if(d){var e=[],t=[];a.forEach((function(a,n){n===o?(t.push({coordinates:{lat:a.startStationLatitude,lon:a.startStationLongitude},properties:{title:a.startStationName}}),t.push({coordinates:{lat:a.endStationLatitude,lon:a.endStationLongitude},properties:{title:a.endStationName}})):(e.push({coordinates:{lat:a.startStationLatitude,lon:a.startStationLongitude},properties:{title:""}}),e.push({coordinates:{lat:a.endStationLatitude,lon:a.endStationLongitude},properties:{title:""}}))})),L.setPoints(e),M.setPoints(t)}}),[M.setPoints,d,L.setPoints,a,o]),r.a.createElement("div",Object.assign({},i,{ref:s}))},L=a(56),M=a(58),w=a(63),k=function(){return r.a.createElement(L.a,null,r.a.createElement(M.a,null,r.a.createElement(w.a,null,"\u0412\u0440\u0435\u043c\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u043f\u043e\u0435\u0437\u0434\u043a\u0438"),r.a.createElement(w.a,null,"\u0422\u043e\u0447\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f"),r.a.createElement(w.a,null,"\u0412\u0440\u0435\u043c\u044f \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f \u043f\u043e\u0435\u0437\u0434\u043a\u0438"),r.a.createElement(w.a,null,"\u0422\u043e\u0447\u043a\u0430 \u043f\u0440\u0438\u0431\u044b\u0442\u0438\u044f"),r.a.createElement(w.a,null,"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0435\u0437\u0434\u043a\u0438")))},I=a(31),C=a.n(I),P=function(e){var t=e.ride,a=e.index,o=e.onMouseEnter,i=e.onMouseLeave,c=Object(n.useMemo)((function(){return C()(60*t.tripduration*1e3,{units:["d","h","m"]})}),[t.tripduration]),u=Object(n.useCallback)((function(){o(a)}),[a,o]);return r.a.createElement(M.a,{onMouseEnter:u,onMouseLeave:i},r.a.createElement(w.a,null,t.starttime.toLocaleString()),r.a.createElement(w.a,null,t.startStationName),r.a.createElement(w.a,null,t.stoptime.toLocaleString()),r.a.createElement(w.a,null,t.endStationName),r.a.createElement(w.a,null,c))},D=a(32);function N(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"")}var R,F=(R={starttime:function(e){return new Date(e)},stoptime:function(e){return new Date(e)}},function(e,t){var a=R[t];return a?a(e):e});function J(){var e=Object(n.useState)(),t=Object(u.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){new Promise((function(e,t){Object(D.parse)("".concat("/habidatum-demo","/bike-rides.csv"),{download:!0,dynamicTyping:!0,complete:e,error:t,header:!0,transformHeader:N,transform:F})})).then((function(e){return r(e)}))}),[]),{data:a}}var W=Object(l.a)((function(e){return Object(s.a)({root:{display:"flex"},tableWrapper:{width:"50%",maxHeight:"100vh",overflowY:"auto",flexShrink:0},mapWrapper:{position:"relative",flexShrink:0,flexGrow:1},map:{position:"absolute",left:0,top:0,width:"100%",height:"100vh"}})}));function H(){var e=J().data,t=W(),a=Object(n.useState)(),o=Object(u.a)(a,2),i=o[0],c=o[1],l=Object(n.useCallback)((function(){c(void 0)}),[]);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.tableWrapper},r.a.createElement(d.a,null,r.a.createElement(k,null),r.a.createElement(p.a,null,null===e||void 0===e?void 0:e.data.map((function(e,t){return r.a.createElement(P,{index:t,key:"".concat(e.starttime.toISOString()," ").concat(e.bikeid),ride:e,onMouseEnter:c,onMouseLeave:l})}))))),r.a.createElement("div",{className:t.mapWrapper},r.a.createElement(x,{rides:null===e||void 0===e?void 0:e.data,className:t.map,selectedRideIndex:i})))}var Z=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,null),r.a.createElement(H,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[35,1,2]]]);
//# sourceMappingURL=main.db10bb93.chunk.js.map