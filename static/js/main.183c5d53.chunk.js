(this["webpackJsonphabidatum-demo"]=this["webpackJsonphabidatum-demo"]||[]).push([[0],{46:function(e,t,a){e.exports=a(56)},56:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(37),o=a.n(c),i=a(74),l=a(21),u=a(71),s=a(76),m=a(72),d=a(73),p=a(17),b=a(12);var f=a(13);var h=a(30),j={"circle-radius":7,"circle-color":"#FF0000"},O=function(e){var t=e.rides,a=e.selectedRide,c=Object(h.a)(e,["rides","selectedRide"]),o=Object(n.useMemo)((function(){var e=Math.min.apply(Math,Object(f.a)(t.map((function(e){return e.tripduration})))),n=Math.max.apply(Math,Object(f.a)(t.map((function(e){return e.tripduration}))));return(a.tripduration-e)/(n-e)*1+1}),[t,a.tripduration]),i=Object(n.useMemo)((function(){return Object(b.a)(Object(b.a)({},j),{},{"circle-radius":j["circle-radius"]*o})}),[o]);return r.a.createElement(p.a,Object.assign({},c,{type:"circle",paint:i}))},v={"circle-radius":5,"circle-color":"#007cbf"},E=function(e){return r.a.createElement(p.a,Object.assign({},e,{type:"circle",paint:v}))};function g(e){var t=e.rides,a=e.children,c=Object(n.useMemo)((function(){var e={type:"FeatureCollection",features:[]};return t.forEach((function(t){e.features.push({type:"Feature",geometry:{type:"Point",coordinates:[t.startStationLongitude,t.startStationLatitude]},properties:{title:t.startStationName}}),e.features.push({type:"Feature",geometry:{type:"Point",coordinates:[t.endStationLongitude,t.endStationLatitude]},properties:{title:t.endStationName}})})),e}),[t]);return r.a.createElement(p.b,{type:"geojson",data:c},a)}var S=function(e){var t=e.layout,a=e.paint,c=Object(h.a)(e,["layout","paint"]);return t=Object(n.useMemo)((function(){return Object(b.a)({"text-field":["get","title"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,2],"text-anchor":"bottom"},t)}),[t]),a=Object(n.useMemo)((function(){return Object(b.a)({"text-halo-color":"rgba(255, 255, 255, 0.8)","text-halo-width":10},a)}),[a]),r.a.createElement(p.a,Object.assign({},c,{type:"symbol",layout:t,paint:a}))},w=[],y=function(e){var t=e.rides,a=void 0===t?w:t,c=e.selectedRide,o=e.className,i=function(e){var t=Object(n.useState)(Object(b.a)({latitude:0,longitude:0,zoom:5},e)),a=Object(l.a)(t,2),r=a[0],c=a[1],o=Object(n.useRef)(r);Object(n.useEffect)((function(){o.current=r}),[r]);var i=Object(n.useCallback)((function(e){c(Object(b.a)(Object(b.a)({},o.current),e))}),[]),u=Object(n.useCallback)((function(e){c(Object(b.a)(Object(b.a)({},e.viewState),e.newViewState))}),[]);return{viewState:r,setViewState:c,handleViewChanged:u,setPartialViewportState:i}}({zoom:11}),u=i.viewState,s=i.handleViewChanged,m=i.setPartialViewportState,d=function(e){return Object(n.useMemo)((function(){if(0!==e.length){var t=[].concat(Object(f.a)(e.map((function(e){return e.startStationLongitude}))),Object(f.a)(e.map((function(e){return e.endStationLongitude})))),a=[].concat(Object(f.a)(e.map((function(e){return e.startStationLatitude}))),Object(f.a)(e.map((function(e){return e.endStationLatitude})))),n=Math.min.apply(Math,Object(f.a)(t)),r=Math.max.apply(Math,Object(f.a)(t)),c=Math.min.apply(Math,Object(f.a)(a));return{latitude:c+(Math.max.apply(Math,Object(f.a)(a))-c)/2,longitude:n+(r-n)/2}}}),[e])}(a);Object(n.useEffect)((function(){d&&m(d)}),[d,m]);var h=Object(n.useMemo)((function(){return c?[c]:void 0}),[c]);return r.a.createElement(p.c,Object.assign({},u,{mapboxApiAccessToken:"pk.eyJ1IjoibmlraXRhbGkiLCJhIjoiY2tnajJzdGZrMDNuNDJzcDlpcjFvcDVkOSJ9.-QspCzoFYrNoP41d3ZL_Mg",mapStyle:"mapbox://styles/mapbox/streets-v11",width:"100%",height:"100%",className:o,onViewStateChange:s}),r.a.createElement(g,{rides:a},r.a.createElement(E,null)),h&&c&&r.a.createElement(r.a.Fragment,null,r.a.createElement(g,{rides:h},r.a.createElement(O,{rides:a,selectedRide:c})),r.a.createElement(g,{rides:h},r.a.createElement(S,null))))},M=a(68),x=a(70),k=a(75),L=function(){return r.a.createElement(M.a,null,r.a.createElement(x.a,null,r.a.createElement(k.a,null,"\u0412\u0440\u0435\u043c\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u043f\u043e\u0435\u0437\u0434\u043a\u0438"),r.a.createElement(k.a,null,"\u0422\u043e\u0447\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f"),r.a.createElement(k.a,null,"\u0412\u0440\u0435\u043c\u044f \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f \u043f\u043e\u0435\u0437\u0434\u043a\u0438"),r.a.createElement(k.a,null,"\u0422\u043e\u0447\u043a\u0430 \u043f\u0440\u0438\u0431\u044b\u0442\u0438\u044f"),r.a.createElement(k.a,null,"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0435\u0437\u0434\u043a\u0438")))},N=a(43),C=a.n(N),F=function(e){var t=e.ride,a=e.onMouseEnter,c=e.onMouseLeave,o=Object(n.useMemo)((function(){return C()(60*t.tripduration*1e3,{units:["d","h","m"]})}),[t.tripduration]),i=Object(n.useCallback)((function(){a(t)}),[a,t]);return r.a.createElement(x.a,{onMouseEnter:i,onMouseLeave:c},r.a.createElement(k.a,null,t.starttime.toLocaleString()),r.a.createElement(k.a,null,t.startStationName),r.a.createElement(k.a,null,t.stoptime.toLocaleString()),r.a.createElement(k.a,null,t.endStationName),r.a.createElement(k.a,null,o))},V=a(44);function J(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"")}var R,D=(R={starttime:function(e){return new Date(e)},stoptime:function(e){return new Date(e)}},function(e,t){var a=R[t];return a?a(e):e});function P(){var e=Object(n.useState)(),t=Object(l.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){new Promise((function(e,t){Object(V.parse)("".concat("/habidatum-demo","/bike-rides.csv"),{download:!0,dynamicTyping:!0,complete:e,error:t,header:!0,transformHeader:J,transform:D})})).then((function(e){return r(e)}))}),[]),{data:a}}var W=Object(u.a)((function(e){return Object(s.a)({root:{display:"flex"},tableWrapper:{width:"50%",maxHeight:"100vh",overflowY:"auto",flexShrink:0},mapWrapper:{position:"relative",flexShrink:0,flexGrow:1},map:{position:"absolute",left:0,top:0,width:"100%",height:"100vh"}})}));function z(){var e=P().data,t=W(),a=Object(n.useState)(),c=Object(l.a)(a,2),o=c[0],i=c[1],u=Object(n.useCallback)((function(){i(void 0)}),[]);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.tableWrapper},r.a.createElement(m.a,null,r.a.createElement(L,null),r.a.createElement(d.a,null,null===e||void 0===e?void 0:e.data.map((function(e,t){return r.a.createElement(F,{key:"".concat(e.starttime.toISOString()," ").concat(e.bikeid),ride:e,onMouseEnter:i,onMouseLeave:u})}))))),r.a.createElement("div",{className:t.mapWrapper},r.a.createElement(y,{rides:null===e||void 0===e?void 0:e.data,className:t.map,selectedRide:o})))}var A=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a,null),r.a.createElement(z,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[46,1,2]]]);
//# sourceMappingURL=main.183c5d53.chunk.js.map